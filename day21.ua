# Experimental!

Parse â† âŠœ(â‰ @#)â‰ @\n.
Directions â† [0_1 Â¯1_0 0_Â¯1 1_0]

Step â† (
  âŠâ˜‡1â‰¡(+Directions Â¤) # get unique neighbors
  âŠƒ(
    â¬š0âŠ¡
  | /â†§â‰â‰¥Â¤0_0
  | âŠ™âˆ˜
  )  # check map
  â–½Ã— # reject rocks and outside cells
)
Relen â† (
  :
  â¬š0 â†¯ â‡Œ âŠŸ âŠ™: âŠ¡1â–³.
)
Resize â† (
  ,:
  âœâŠ™â‰Relen : Relen
)

Hash â† (
  â¤"hash number arrays only"=0type.
  â™­â‹¯+4294967296â™­
  â¬š0â†¯ Â¯1_32
  /(
    âŠ™âœÂ°â‹¯(Ã—31)
    â¬š0=
  )
  Â°â‹¯
)

â¤âŠƒâ‹…âˆ˜ â‰  âˆ©Hash 0 1
â¤âŠƒâ‹…âˆ˜ â‰  âˆ©Hash 0 0_0
â¤âŠƒâ‹…âˆ˜ â‰  âˆ©Hash 0_0 0_0_0

# ( size matrix -- matrixes )
CutUp â† (
  .
  â˜‡2 â‰¡(â‰¡â‰ â†¯ âŠ‚ âŠƒ(âˆ˜|âŠ‚ Â¯1 âŠ¢â‡Œâ–³.;)âŠ™â‰) Â¤ âŠ™(â†¯ âŠ‚ âŠƒ(âˆ˜|âŠ‚ Â¯1 âŠ¢â‡Œâ–³.;))
)

Trim â† (
  âŠƒ(âŠ¡0_0)âˆ˜
  âŠƒ(âŠ™âˆ˜|âˆ˜)
  â‰ ,
  â‰¡/â†¥
  â–½
  â‰
  âŠ™.:
  â‰¡/â†¥â‰ 
  â–½
  â‰
)

Trim [9_9_9_9
      9_1_2_9
      9_3_4_9
      9_9_9_9]

â¤âŠƒâ‹…âˆ˜â‰ [1_2
       3_4]

$ ...........
$ .....###.#.
$ .###.##..#.
$ ..#.#...#..
$ ....#.#....
$ .##..S####.
$ .##..#...#.
$ .......##..
$ .##.#.####.
$ .##..##.##.
$ ...........
Input â†
RealTargetStep â† 1000

Input â† &fras "day21.txt"
RealTargetStep â† 26501365

GardenSize â† â§» Parse Input
CycleLength â† Ã—2 GardenSize
GrowSize â† 21
TargetStep â† -â—¿2.RealTargetStep
Modulus â† â—¿ CycleLength RealTargetStep

SimulatedSteps â† 1115 # + â—¿2 RealTargetStep Ã—4 CycleLength 

Walk â† (
  â—¿2. # check for oddness
  (
    # even
    Ã·2
    âŠ™0 # counter
  |    # odd
    âŒŠÃ·2
    âŠ™1 # counter
    âŠ™âŠ™Step
  )
  â¥(
    +2 # bump counter
    âŠ™(
      Step
      Step
    )
    (
      # do nothing
    | # -- counter visitedlist garden
      âŠ™(
        # -- visitedlist garden
        âŠƒ(
          (
            # hash viz
            Â°âŠš
            # -- visitedmatrix largegarden
            Resize â§»: # resize to largegarden size

            CutUp GrowSize
            â‰¡Hash
            â†¯ âŠŸ . GrowSize
            Trim
            # âœ(â™­â†»âŠŸ.âŒˆÃ·2GrowSize)âŠ› # classify hashes
            âœâ™­âŠ› # classify hashes
            âˆµ(âŠ¡:" abcdefghijklmnopqrstuv")

            # +@ğŸŒ€ â—¿120
            # +@A â—¿300
            # +1000 â—¿1000
            â‰¡(/âŠ‚â‰â¬š@\sâŠŸ" "â‰)
            â‰¡&p
                | # 
          )1
            | # 

          â§»:        # get large garden size
          Ã·GrowSize # recover minigarden size
          âŒŠÃ·        # convert to minigarden coord
          Â°âŠš        # compute occupancy for each minigarden
          # Resize GrowSize # match map size

          &p$"occ:_"Trim. # show occupancies
          ;
            | # 
          âŠ™âˆ˜
        )
      )
    )â†§âŠƒ(=Modulusâ—¿CycleLength|>Ã—0 CycleLength).
    âŠƒâŠ™âˆ˜â‹…(
      âŠ¢â‰
      /â†§
      &p$"min=_".
      â¤"warning, getting out of garden">0
    )
    &p$"n=_ S=_"âŠƒ(âŠ™â§»|âŠ™âˆ˜)
  )
  ; # &p
  âŠ™;
)
Center â† [.]âŒŠÃ·2â§»
PartOne â† (
  âŠ™Parse
  âŠ™(Â¤Center.)
  # âŠ™âŠ™(&p$"_ garden cells out of _"âŠƒ(/+|â§»)â™­.)
  â§»Walk
)
Grow â† (
  â¤"odd only"=1â—¿2.
  â‰ â–½ âŠ™(â‰â–½) .
)
---
Aeq â† â¤âŠƒ($"\nexpected\n_\ngot\n_")â‰

$ ...........
$ .....###.#.
$ .###.##..#.
$ ..#.#...#..
$ ....#.#....
$ .##..S####.
$ .##..#...#.
$ .......##..
$ .##.#.####.
$ .##..##.##.
$ ...........
; # Aeq 16 PartOne 6.

# &fras "day21.txt";

&p "Tests OK"
---
# â¤âŠƒâ‹…âˆ˜â‰ 3709 PartOne 64 &fras "day21.txt"
# â¤âŠƒâ‹…âˆ˜â‰ 3709 &pâœnow PartOne 2 [65_65] &fras "day21.txt"
# â¤âŠƒâ‹…âˆ˜â‰ 0 &pâœnow PartTwo &fras "day21.txt"

Parse Input
Grow GrowSize
Walk SimulatedSteps Center.
# &ims Â°âŠš.
â§»
